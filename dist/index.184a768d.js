class e{static geocode(e){return new Promise(((t,a)=>{fetch(`https://blooming-sands-36961.herokuapp.com/geocode?address=${e}`).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{a(e)}))}))}static reverseGeocode(e,t,a){return new Promise(((a,s)=>{fetch(`https://blooming-sands-36961.herokuapp.com/reversegeocode?lat=${e}&lon=${t}`).then((e=>e.json())).then((e=>{a(e.results[0].address_components[0].long_name)})).catch((e=>{s(e)}))}))}}class t{static getDateTime(e){return luxon.DateTime.now().setZone(e)}static toCelsius(e){return 5*(e-32)/9}static isDay(e){const t=this.getDateTime(e).hour;return t>5&&t<18}static shuffle(e){var t,a,s;for(s=e.length-1;s>0;s--)t=Math.floor(Math.random()*(s+1)),a=e[s],e[s]=e[t],e[t]=a;return e}static toggleHidden(e){return e.classList.toggle("hidden")}static toggleDisabled(e){return!0===e.disabled?e.disabled=!1:e.disabled=!0}}class a{static background=document.querySelector(".js-animations");static foregroundImageElement=document.querySelector(".js-foregroundImage");static lightningInterval;static defaultColorPalette=[[56,51,105],[106,57,116],[152,63,117],[192,74,109],[221,95,94],[233,104,109],[244,113,124],[255,122,139],[242,130,188],[206,149,227],[155,168,247],[101,183,246]];static defaultGrayScalePalette=[[40,39,49],[51,50,59],[62,61,70],[73,72,81],[85,84,92],[97,96,103],[9,108,115],[122,121,127],[134,134,139],[147,147,151],[161,160,164],[174,173,176],[187,187,189],[201,201,202],[215,215,215]];static clearParticles(){const e=Array.from(document.getElementsByClassName("js-gfx"));e.length>0&&e.forEach((e=>e.remove()))}static toggleParticleAnimations(){const e=Array.from(document.getElementsByClassName("js-gfx"));e.length>0&&e.forEach((e=>e.classList.toggle("paused")))}static drawParticles(e,t){let a="Rain"===e?["fas","fa-tint","rain","particle","js-gfx"]:["fas","fa-snowflake","snow","particle","js-gfx"],s="Rain"===e?500:2e3;for(let e=0;e<t;e++){let e=document.createElement("i");e.alt="",e.style.left=`${Math.floor(100*Math.random())}%`,e.style.top=`${Math.floor(10*Math.random()+10)}%`,e.style.animationDelay=`${Math.floor(500+1e3*Math.random())}ms`,e.style.animationDuration=`${Math.floor(s+1e3*Math.random())}ms`,a.forEach((t=>e.classList.add(t))),this.background.appendChild(e)}}static getNumClouds(e){switch(e){case 801:return 2;case 802:return 3;case 803:return 4;case 804:return 5;default:return 1}}static drawClouds(e,a){let s=e;s<0&&(s=1),s>5&&(s=5);let n=t.shuffle([1,2,3,4,5]);const o=t.isDay(a);for(let e=0;e<s;e++){let t=document.createElement("img");t.src=`../images/cloud${e+1}.png`,t.alt="",t.classList.add("cloud",`speed-${n[e]}`,"js-gfx"),o||t.classList.add("half-opacity"),this.background.appendChild(t)}}static drawLightning(){const e=document.createElement("div");e.classList.add("lightning","js-gfx"),this.background.appendChild(e),this.lightningInterval&&clearInterval(this.lightningInterval),setInterval((()=>{setTimeout((()=>{e.classList.add("lightning-animation"),setTimeout((()=>{e.classList.remove("lightning-animation")}),2e3)}),6e3*Math.random()+6e3)}),6e3)}static drawAtmosphere(e){let t="";e||(t="fog"),t="Sand"===e||"Dust"===e?"sand":"fog";const a=document.createElement("div");a.classList.add("atmosphere","layer-1",`${t}-1`,"fade","js-gfx"),this.background.appendChild(a);const s=document.createElement("div");s.classList.add("atmosphere","layer-2",`${t}-2`,"fade","js-gfx"),this.background.appendChild(s)}static animateWeatherGFX(e,{id:t,timezone:a}){switch(this.clearParticles(),e){case"Clouds":this.drawClouds(this.getNumClouds(t));break;case"Thunderstorm":this.drawClouds(5,a),this.drawParticles("Rain",50),this.drawLightning();break;case"Drizzle":this.drawClouds(4,a),this.drawParticles("Rain",15);break;case"Rain":this.drawClouds(5,a),this.drawParticles("Rain",25);break;case"Snow":this.drawClouds(5,a),this.drawParticles("Snow",40);break;case"Mist":case"Ash":case"Fog":case"Smoke":case"Haze":this.drawClouds(3,a),this.drawAtmosphere("Fog");break;case"Dust":case"Sand":this.drawClouds(3,a),this.drawAtmosphere("Sand");break;case"Squall":case"Tornado":case"Clear":break;default:console.error("Invalid weather condition.")}}static getStages(e,t,a){const s=[],n=(t-e)/a;for(let t=0;t<a;t++)s.push(Math.round(n*t+e));return s}static getNearestStages(e,t){for(let a=0;a<e.length-1;a++)if(t>=e[a]&&t<=e[a+1])return[{stage:e[a],index:a},{stage:e[a+1],index:a+1}];return-1}static percentToNextStage(e,t,a){return(a-e)/(t-e)*100}static calculateColor(e,t,a){const s=(e,t,a)=>{const s=Math.floor((e-t)*a+e);return s>255?255:s};let n=this.percentToNextStage(t[0].stage,t[1].stage,a)/100,o=e[t[0].index],i=e[t[1].index],r=[];return r.push(s(o[0],i[0],n)),r.push(s(o[1],i[1],n)),r.push(s(o[2],i[2],n)),r}static setColor(e){this.background.style.background=`\n          linear-gradient(to top, rgb(${e[0]}, ${e[1]}, ${e[2]}), rgb(${Math.floor(.9*e[0])}, ${Math.floor(.9*e[1])}, ${Math.floor(.9*e[2])})\n        `}static paintBackground(e,{sunrise:t,sunset:a},s=this.defaultColorPalette,n=this.defaultGrayScalePalette){this.background.style.background="",this.foregroundImageElement.style.opacity=1;let o=[];o="Clear"===e||"Clouds"===e?s:n;const i=3600;let r=Math.floor(Date.now()/1e3);if(r<t)return this.foregroundImageElement.style.opacity=.5,void this.setColor(o[0]);if(r>=t&&r<=t+i){let e=this.getStages(t,t+i,o.length),a=this.getNearestStages(e,r);return this.foregroundImageElement.style.opacity=.75,-1===a?void this.setColor(o[o.length-1]):void this.setColor(this.calculateColor(o,a,r))}if(r>t+i&&r<a-i)this.setColor(o[o.length-1]);else{if(r>=a-i&&r<=a){let e=this.getStages(a-i,a,o.length),t=this.getNearestStages(e,r);return this.foregroundImageElement.style.opacity=.75,-1===t?void this.setColor(o[0]):void this.setColor(this.calculateColor(o.slice().reverse(),t,r))}this.foregroundImageElement.style.opacity=.5,this.setColor(o[0])}}}class s{static getIcon(e,a,s){let n,o;switch(t.isDay(s)?(n=["fas","fa-sun"],o=["fas","fa-cloud-sun"]):(n=["fas","fa-moon"],o=["fas","fa-cloud-moon"]),a){case"Thunderstorm":return["fas","fa-bolt"];case"Drizzle":return["fas","fa-cloud-rain"];case"Rain":return["fas","fa-cloud-showers-heavy"];case"Snow":return["fas","fa-snowflake"];case"Mist":case"Smoke":case"Haze":case"Dust":case"Fog":case"Sand":case"Ash":case"Squall":case"Tornado":return["fas","fa-smog"];case"Clear":return n;case"Clouds":return Number.parseInt(e)<803?o:["fas","fa-cloud"];default:return["fas","fa-cloud"]}}static displayWeather({id:e,weather:t,timezone:a}){const s=document.querySelector(".js-weatherIcon");s.classList="weather__icon font-lg js-weatherIcon";const n=document.querySelector(".js-weatherStatus");let o=[];o=this.getIcon(e,t,a),o.forEach((e=>s.classList.add(e))),n.innerHTML=t}static displayTemperature({temperature:e,feels_like:a,max:s,min:n,unit:o}){let i=[e,a,s,n].map((e=>("celsius"===o&&(e=t.toCelsius(e)),Math.round(e))));const r="celsius"===o?"C":"F";document.querySelector(".js-temperature").innerHTML=`${i[0]}&deg;${r}`;document.querySelector(".js-feelsLike").innerHTML=`Feels like ${i[1]}&deg;${r}`;document.querySelector(".js-highTemperature").innerHTML=`High: ${i[2]}&deg;${r}`;document.querySelector(".js-lowTemperature").innerHTML=`Low: ${i[3]}&deg;${r}`}static displayForecast({forecast:e,unit:a}){const s=e.slice(1),n=document.querySelector(".js-forecast");for(;n.firstChild;)n.firstChild.remove();const o=document.createElement("h3");o.classList.add("forecast__title","font-med"),o.innerText="7 Day Forecast:",n.appendChild(o);const i=document.createElement("div");i.classList.add("forecast__container"),o.appendChild(i);const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];let l=(new Date).getUTCDay();s.forEach((e=>{const s="celsius"===a?t.toCelsius(e.temp.max):e.temp.max,n="celsius"===a?t.toCelsius(e.temp.min):e.temp.min,o=document.createElement("div");o.classList.add("forecast__subcontainer");const c=document.createElement("p");l+=1,l<7||(l=0),c.innerText=r[l],c.classList.add("font-xs-sm"),o.appendChild(c);const d=document.createElement("i");this.getIcon(e.weather[0].id,e.weather[0].main).forEach((e=>d.classList.add(e))),d.classList.add("font-xs-sm"),o.appendChild(d);const g=document.createElement("p");g.innerHTML=`${Math.round(s)}&deg;`,g.classList.add("font-xs-sm"),o.appendChild(g);const u=document.createElement("p");u.innerHTML=`${Math.round(n)}&deg;`,u.classList.add("forecast__container--low-temp","font-xs-sm"),o.appendChild(u),i.appendChild(o)}))}static displayLocation({location:e}){const t=document.querySelector(".js-location"),a=e.toLowerCase().split(" ");if(1===a.length)return void(t.innerHTML=`${e[0].toUpperCase()}${e.slice(1)}`);const s=a.map((e=>e[0].toUpperCase()+e.substring(1)));t.innerHTML=`${s.join(" ")}`}static displayDate({timezone:e}){document.querySelector(".js-date").innerText=`${t.getDateTime(e).toFormat("cccc',' LLLL d")}`}static displayTime({timezone:e,clockElement:a}){const s=luxon.DateTime;a.innerHTML=t.getDateTime(e).toLocaleString(s.TIME_WITH_SECONDS)}}const n={toggleSettingsMenu:document.querySelector(".js-toggleSettingsMenu"),closeSettingsMenu:document.querySelector(".js-closeSettingsMenu"),settingsOptions:Array.from(document.querySelectorAll(".js-settingsOption")),start:document.querySelector(".js-start"),toggleFarenheit:document.querySelector(".js-toggleFarenheit"),toggleCelsius:document.querySelector(".js-toggleCelsius"),reset:document.querySelector(".js-reset"),searchSubmit:document.querySelector(".js-searchSubmit"),navToggle:document.querySelector(".js-navToggle"),navToggleOuter:document.querySelector(".js-navToggleOuter")},o={nav:document.querySelector(".js-nav"),weatherWrapper:document.querySelector(".js-weatherWrapper"),loader:document.querySelector(".js-loader"),loaderMessage:document.querySelector(".js-loaderMessage")},i={search:document.querySelector(".js-searchInput")},r={settingsMenu:document.querySelector(".js-settingsIcon")},l={google:document.getElementById("js-google")},c=document.querySelector(".js-settingsContainer"),d={toggleSearch:function(){t.toggleDisabled(i.search),t.toggleDisabled(n.searchSubmit)},toggleMenu:function(){this.toggleSearch(),t.toggleHidden(c)},toggleUnitButtons:function(){t.toggleHidden(n.toggleFarenheit),t.toggleHidden(n.toggleCelsius)},toggleWeatherWrapper:function(){t.toggleHidden(o.weatherWrapper)},toggleNav:function(){t.toggleHidden(o.nav),t.toggleHidden(n.navToggleOuter)},toggleLoader:function(){t.toggleHidden(o.loader)},clearLoaderMessage:function(){o.loaderMessage.innerHTML=""}},g=new class{constructor(){this.state={isPaused:!1,refreshData:"",timeRemainingInCycle:6e4,updateTimeRemainingInCycle:"",clockInterval:void 0,weather:"",id:"",temperature:0,feels_like:0,max:"",min:"",toggledWeather:"",unit:localStorage.getItem("unit"),timezone:"",sunrise:0,sunset:0,forecast:"",lat:0,lon:0,location:"",clockElement:document.querySelector(".js-clock")}}updateState(...e){if(2===e.length)return this.state[e[0]]=e[1];e[0].forEach((e=>{this.state[e[0]]=e[1]}))}updateClock(){clearInterval(this.state.clockInterval),s.displayTime(this.state),this.updateState("clockInterval",setInterval((()=>{s.displayTime(this.state)}),1e3))}render(){const e=this.state.toggledWeather?this.state.toggledWeather:this.state.weather,n=this.state,o=document.querySelector(".js-weatherWrapper");o.classList.contains("hidden")&&t.toggleHidden(o),this.updateClock(),s.displayDate(n),s.displayLocation(n),s.displayWeather(n),s.displayTemperature(n),s.displayForecast(n),a.animateWeatherGFX(e,n),a.paintBackground(e,n)}async getWeather({lat:e,lon:t}){return new Promise(((a,s)=>{fetch(`https://blooming-sands-36961.herokuapp.com/weather?lat=${e}&lon=${t}`).then((e=>e.json())).then((e=>{a(e)})).catch((e=>{s(e)}))}))}async updateWeatherData(){return await this.getWeather(this.state).then((e=>{this.updateState([["weather",e.current.weather[0].main],["id",e.current.weather[0].id],["temperature",e.current.temp],["feels_like",e.current.feels_like],["max",e.daily[0].temp.max],["min",e.daily[0].temp.min],["today",e.daily[0]],["timezone",e.timezone],["sunrise",e.daily[0].sunrise],["sunset",e.daily[0].sunset],["forecast",e.daily]])}))}async keepWeatherDataUpdated(e){e||(this.state.timeRemainingInCycle=6e4),clearTimeout(this.state.refreshData),clearInterval(this.state.updateTimeRemainingInCycle);const t=async()=>{await this.updateWeatherData().then((()=>{this.render(),this.keepWeatherDataUpdated()}))};this.state.updateTimeRemainingInCycle=setInterval((()=>{this.state.timeRemainingInCycle-=100,this.state.timeRemainingInCycle<=0&&t()}),100),this.state.refreshData=setTimeout((()=>{t()}),this.state.timeRemainingInCycle)}async getLocationData(){return new Promise(((e,t)=>{const a=t=>{e({lat:t.coords.latitude,lon:t.coords.longitude})},s=e=>{t(e)};window.navigator.geolocation?window.navigator.geolocation.getCurrentPosition(a,s):alert("Geolocation is not supported by your browser.")}))}async updateLocationData(t){await e.geocode(t).then((e=>{this.updateState([["lat",e.results[0].geometry.location.lat],["lon",e.results[0].geometry.location.lng]])}))}toggleIsPaused(){return!this.state.isPaused}toggleAppPause(){if(!this.state.isPaused)return this.state.isPaused=this.toggleIsPaused(),clearInterval(this.state.updateTimeRemainingInCycle),clearTimeout(this.state.refreshData),void a.toggleParticleAnimations();this.state.isPaused=this.toggleIsPaused(),a.toggleParticleAnimations(),this.keepWeatherDataUpdated(!0)}toggleDisplayUnits(){s.displayTemperature(this.state),s.displayForecast(this.state)}async initialize(){await this.getLocationData().then((e=>{this.updateState([["lat",e.lat],["lon",e.lon]])})).then((async()=>{await e.reverseGeocode(this.state.lat,this.state.lon).then((e=>this.state.location=e))})).then((async()=>{await this.updateWeatherData()})).then((()=>{this.render(),this.keepWeatherDataUpdated()})).catch((e=>{console.error(e)}))}};new class{constructor(e,t,a){this.searchBar=e,this.googleScript=t,this.options=a,this.googleScript=t,this.googleScript.addEventListener("load",(()=>{this.autocomplete=new google.maps.places.Autocomplete(this.searchBar,this.options),google.maps.event.clearInstanceListeners(this.searchBar),google.maps.event.addListener(this.autocomplete,"place_changed",(()=>{this.autocomplete.getPlace()}))}))}}(i.search,l.google,{types:["(cities)"]});d.toggleLoader(),t.toggleDisabled(n.toggleSettingsMenu);let u=!1;i.search.value="",n.start.addEventListener("click",(async()=>{t.toggleDisabled(n.toggleSettingsMenu),u=!0,d.clearLoaderMessage(),await g.initialize().then((()=>{d.toggleLoader()}))})),n.searchSubmit.addEventListener("click",(async()=>{if(!i.search.value)return;clearInterval(g.state.clockInterval),g.updateState("location",i.search.value.slice(0,i.search.value.indexOf(",")));const e=i.search.value.replaceAll(/\s|,\s/g,"+");!0===u?d.toggleLoader():(u=!0,d.clearLoaderMessage()),d.toggleSearch(),await g.updateLocationData(e).then((async()=>{await g.updateWeatherData()})).then((()=>{g.render(),g.keepWeatherDataUpdated(),d.toggleLoader(),d.toggleSearch(),n.toggleSettingsMenu.disabled=!1,o.weatherWrapper.classList.contains("hidden")&&d.toggleWeatherWrapper()})).catch((e=>{alert("Invalid location. Click [Ok] then try a different location."),d.toggleLoader(),d.toggleSearch()}))})),n.navToggle.addEventListener("click",(()=>{d.toggleNav()})),n.navToggleOuter.addEventListener("click",(()=>{d.toggleNav()})),n.toggleSettingsMenu.addEventListener("click",(()=>{d.toggleMenu(),g.toggleAppPause()})),n.closeSettingsMenu.addEventListener("click",(()=>{d.toggleMenu(),g.toggleAppPause()})),n.settingsOptions.forEach((e=>{e.addEventListener("mouseover",(()=>{r.settingsMenu.className=`fas fa-${e.id}`}))})),n.settingsOptions.forEach((e=>{e.addEventListener("mouseout",(()=>{r.settingsMenu.className="fas fa-cloud-sun"}))})),n.settingsOptions.forEach((e=>{e.addEventListener("click",(()=>{g.updateState("toggledWeather",e.dataset.weather),d.toggleMenu(),g.toggleAppPause(),g.keepWeatherDataUpdated(),g.render()}))})),n.reset.addEventListener("click",(()=>{g.updateState([["toggledWeather",""],["timeRemainingInCycle",6e4]]),g.toggleAppPause(),d.toggleMenu(),g.render()})),"celsius"===localStorage.getItem("unit")&&d.toggleUnitButtons(),n.toggleFarenheit.addEventListener("click",(()=>{g.updateState("unit","imperial"),localStorage.setItem("unit","imperial"),d.toggleUnitButtons(),g.toggleDisplayUnits(n.toggleFarenheit,n.toggleCelsius)})),n.toggleCelsius.addEventListener("click",(()=>{g.updateState("unit","celsius"),localStorage.setItem("unit","celsius"),d.toggleUnitButtons(),g.toggleDisplayUnits()}));
//# sourceMappingURL=index.184a768d.js.map
